<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd file:///opt/casa/code/xmlcasa/xml/casa.xsd">

    <task type="function" name="hif_editimlist" category="pipeline">
        <shortdescription>Add to a list of images to be produced with hif_makeimages()</shortdescription>
        <description>
            Add to a list of images to be produced with hif_makeimages(), which uses hif_tclean() to invoke CASA tclean.  
	    Many of the hif_editimlist() inputs map directly to tclean parameters.
        </description>
        <input>

            <param type="string" name="imagename">
                <description>Prefix for output image names.</description>
                <value/>
            </param>

            <param type="string" name="search_radius_arcsec">
                <description>Size of the field finding beam search radius in arcsec.</description>
                <value/>
            </param>
            <param type="stringArray" name="cell">
                <description>Image X and Y cell size(s) with units or pixels per beam, \'\' for default. Single value same for both. \'&lt;number&gt;ppb\' for pixels per beam.</description>
                <value/>
            </param>

            <!--<param type="string" name="conjbeams">-->
                <!--<description>Use conjugate frequency in tclean for wideband A-terms.</description>-->
                <!--<value/>-->
            <!--</param>-->

            <param type="string" name="cyclefactor">
                <description>Controls the depth of clean in minor cycles based on PSF. </description>
                <value/>
            </param>

            <param type="string" name="cycleniter">
                <description>Controls max number of minor cycle iterations in a single major cycle.</description>
                <value/>
            </param>

            <param type="string" name="deconvolver">
                <description>Minor cycle algorithm (multiscale or mtmfs)</description>
                <value/>
            </param>

            <param type="string" name="editmode">
                <description>The edit mode of the task (e.g. add, edit)</description>
                <value/>
            </param>

            <param type="stringArray" name="field">
                <description>Set of data selection field names or ids, \'\' for all</description>
                <value/>
            </param>

            <param type="string" name="imaging_mode">
                <description>Identity of product type (e.g. VLASS quick look) desired.  This will determine the heuristics used.</description>
                <value/>
            </param>

            <param type="stringArray" name="imsize">
                <description>Image X and Y size(s) in pixels or PB level (single fields), \'\' for default. Single value same for both. \'&lt;number&gt;pb\' for PB level.</description>
                <value/>
            </param>

            <param type="string" name="intent">
                <description>Set of data selection intents</description>
                <value/>
            </param>

            <param type="string" name="gridder">
                <description>Name of the gridder to use with tclean</description>
                <value/>
            </param>

            <param type="string" name="mask">
                <description>Used to declare whether to use a predefined mask for tclean.</description>
                <value/>
            </param>

            <param type="any" name="nbin">
                <description>Channel binning factors per spw, \'\' for default.</description>
                <any type="variant"/>
                <value type="string"/>
            </param>

            <param type="string" name="nchan">
                <description>Number of channels, -1 = all</description>
                <value/>
            </param>

            <param type="string" name="niter">
                <description>Maximum number of clean iterations</description>
                <value/>
            </param>

            <param type="int" name="nterms">
                <description/>
                <value type="int">2</value>
            </param>

            <param type="string" name="parameter_file">
                <description/>
                <value/>
            </param>

            <param type="any" name="phasecenter">
                <description>Image center (direction or field index, \'\' for default)</description>
                <any type="variant"/>
                <value type="string"/>
            </param>

            <param type="string" name="reffreq">
                <description/>
                <value/>
            </param>

            <param type="double" name="robust" subparam="true">
                <shortdescription>Robustness parameter</shortdescription>
                <description>Robustness parameter for Briggs weighting.

                    robust = -2.0 maps to uniform weighting.
                    robust = +2.0 maps to natural weighting.
                    (robust=0.5 is equivalent to robust=0.0 in AIPS IMAGR.)

                </description>
                <value type="double">1.0</value>
                <allowed kind="range">
                    <value range="min">-2.0</value>
                    <value range="max">2.0</value>
                </allowed>
            </param>


            <param type="string" name="scales">
                <description>The scales for multi-scale imaging.</description>
                <value/>
            </param>

            <param type="string" name="specmode">
                <description>Spectral gridding type (mfs, cont, cube, \'\' for default)</description>
                <value/>
            </param>

            <param type="string" name="spw">
                <description>Set of data selection spectral window/channels, \'\' for all</description>
                <value/>
            </param>

            <param type="any" name="start">
                <description>Channel start, \'\' for default</description>
                <any type="variant"/>
                <value type="string"/>
            </param>

            <param type="string" name="stokes">
                <description/>
                <value/>
            </param>

	    <param type="string" name="threshold">
	        <description/>
                <value/>
	    </param>

            <param type="string" name="uvtaper">
                <description>Used to set a uv-taper during clean.</description>
                <value/>
            </param>

            <param type="string" name="uvrange">
                <description>Set of data selection uv ranges, \'\' for all.</description>
                <any type="variant" limittypes="string stringArray"/>
                <value type="string"/>
            </param>

            <param type="any" name="width">
                <description>Channel width, \'\' for default.</description>
                <any type="variant"/>
                <value type="string"/>
            </param>

            <param type="string" name="pipelinemode">
                <description>The pipeline operating mode</description>
                <value>automatic</value>
                <allowed kind="enum">
                    <value>automatic</value>
                    <value>interactive</value>
                    <value>getinputs</value>
                </allowed>
            </param>

            <param type="bool" name="dryrun">
                <description>Run the task (False) or display the command(True)</description>
                <value>False</value>
            </param>

            <param type="bool" name="acceptresults">
                <description>Add the results to the pipeline context</description>
                <value>True</value>
            </param>


            <constraints>
                <!--TODO: add constraints-->
            </constraints>

        </input>

        <output>
            <param type="any" name="results">
                <description>The output results object</description>
                <any type="variant"/>
                <value/>
            </param>
        </output>
        <returns type="void"/>


        <example>

            Edit a list of images to be cleaned.

            Keyword Arguments

            <!--TODO: add description-->
            imagename --

            cell -- Cell size (x, y)
            default '' Compute cell size based on the UV coverage of all the fields
            to be imaged and use a 5 pix per beam sampling.
            The pix per beam specification uses the above default cell size
            ('5ppb') and scales it accordingly.
            example: ['0.5arcsec', '0.5arcsec'] '3ppb'

            cyclefactor -- Controls the depth of clean in minor cycles based on PSF.

            cycleniter -- Controls max number of minor cycle iterations in a single major cycle.

            deconvolver -- Minor cycle algorithm e.g. 'multiscale' or 'mtmfs'.
            default: 'multiscale'

            <!--TODO: add description-->
            editmode --

            field -- Select fields to image. Use field name(s) NOT id(s). Mosaics
            are assumed to have common source / field names. If intent is specified
            only fields with data matching the intent will be selected. The fields
            will be selected from measurement sets in 'vis'.
            default: [''] Fields matching matching intent, one image per target source.
            example: ['3C279'], ['Centaurus*'], ['3C279' ,'J1427-421']

            imsize -- Image X and Y size in pixels or PB level for single field. The
            explicit sizes must be even and divisible by 2,3,5,7 only.
            default: '' The default values are derived as follows:
            1. Determine phase center and spread of field centers around it.
            2. Set the size of the image to cover the spread of field centers plus
            a border of width 0.75 * beam radius, to first null.
            3. Divide X and Y extents by cell size to arrive at the number of
            pixels required.
            The PB level setting for single fields leads to an imsize extending
            to the specified level plus 5% padding in all directions.
            example: [120, 120], '0.3pb'

            intent -- Select intents for which associated fields will be imaged.
            default: 'TARGET'
            example: 'PHASE,BANDPASS'

            <!--TODO: add description-->
            gridder --

            mask -- Used to declare whether to use a predefined mask for tclean,
            or to use internal auto-masking, or to not mask at all.

            nbin -- Channel binning factors per spw
            default: '' Binning factors for each spw. Format: 'spw1:nb1,spw2:nb2,...'
            Optional wildcard: '*:nb'
            example: '9:2,11:4,13:2,15:8'
            '*:2'

            nchan -- Total number of channels in the output image(s)
            default: -1 Selects enough channels to cover the data selected by
            spw consistent with start and width.
            example: 100

            niter -- The maximum total number of minor cycle iterations allowed for tclean.

            <!--TODO: add description-->
            nterms --

            <!--TODO: add description-->
            parameter_file --

            phasecenter -- Direction measure or field id of the image center.
            default: '' The default phase center is set to the mean of the field
            directions of all fields that are to be image together.
            example: 0, 'J2000 19h30m00 -40d00m00'

	    <!-- TODO: add description-->
	    reffreq --


            robust -- Set the Briggs robustness factor for weighting. In general,
            we choose a value that gives suitable PSF size (~2.5? for the
            untapered images) and reasonable sensitivity. Tuning might be needed
            in certain regions.

            scales -- The scales for multi-scale imaging.

            specmode -- Frequency imaging mode, 'mfs', 'cont', 'cube'. \'\' defaults to
            'cube' if intent parameter includes 'TARGET' otherwise 'mfs'.
            default: ''
            example: 'mfs', 'cont', 'cube'
            example:
            mode='mfs' produce one image per source and spw
            mode='cont' produce one image per source and aggregate over all
            specified spws
            mode='cube' produce an LSRK frequency cube, channels are specified
            in frequency

            spw -- Select spectral window/channels to image.
            default: '' Individual images will be computed for all science spectral
            windows.
            example: '9'

            start -- First channel for frequency mode images.
            default '' Starts at first input channel of the spw.
            example: '22.3GHz'

            <!--TODO: add description-->
            stokes --

            <!--TODO: add description-->
            threshold --

            uvtaper -- Used to set a uv-taper during clean. At mid-declinations and
            reasonable elevations, not required for the full-resolution images
            and in the QLIP. Needed when making the tapered Images for other BDPs
            (SEIP, CIP). May be useful in QLIP to control PSF at low elevations
            or in hybrid.

            uvrange -- Select a set of uv ranges to image.
            default: '' All uv data is included
            example: '0~1000klambda', ['0~100klambda', 100~1000klambda]

            width -- Output channel width.
            default: '' Difference in frequency between first 2 selected channels.
            for frequency mode images.
            example: '24.2kHz'
            'pilotimage' for 15 MHz / 8 channel heuristic

            --- pipeline task execution modes

            pipelinemode -- The pipeline operating mode. In 'automatic' mode the pipeline
            determines the values of all context defined pipeline inputs automatically.
            In 'interactive' mode the user can set the pipeline context defined
            parameters manually. In 'getinputs' mode the user can check the settings
            of all pipeline parameters without running the task.
            default: 'automatic'.

            dryrun -- Run the commands (True) or generate the commands to be run but
            do not execute (False).
            default: False

            acceptresults -- Add the results of the task to the pipeline context (True) or
            reject them (False).
            default: True

            Output

            results -- If pipeline mode is 'getinputs' then None is returned. Otherwise
            the results object for the pipeline task is returned.

            Description

            Edit a list of images to be cleaned.

            Issues

            <!--TODO: add issues-->

            Examples

            <!--TODO: add examples-->

        </example>

    </task>
</casaxml>

