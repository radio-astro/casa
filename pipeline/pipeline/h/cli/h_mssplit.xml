<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
		 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
		 xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd file:///opt/casa/code/xmlcasa/xml/casa.xsd">

<task type="function" name="h_mssplit" category="pipeline">
<shortdescription>Select data from calibrated MS(s) to form new MS(s) for imaging</shortdescription>
<description>
</description>
<input>

  <param type="stringArray" name="vis" subparam="true">
    <description>The list of input measurement sets</description>
    <value></value>
  </param>

  <param type="stringArray" name="outputvis" subparam="true">
     <description>The list of output split measurement sets</description>
     <value></value>
  </param>

  <param type="string" name="field" subparam="true">
    <description>Set of data selection field names or ids, \'\' for all</description>
    <value></value>
  </param>

  <param type="string" name="intent" subparam="true">
    <description>Set of data selection intents, \'\' for all</description>
    <value></value>
  </param>

  <param type="string" name="spw" subparam="true">
    <description>Set of data selection spectral window ids \'\' for all</description>
    <value></value>
  </param>

  <param type="string" name="datacolumn" subparam="true">
    <description>The data columns to process</description>
    <value>data</value>
    <allowed kind="enum" ignorecase="True">
        <value>corrected</value>
        <value>data</value>
        <value>model</value>
        <value>data,model,corrected</value>
        <value>float_data</value>
        <value>lag_data</value>
        <value>float_data,data</value>
        <value>lag_data,data</value>
        <value>all</value>
    </allowed>
  </param>

  <param type="int" name="chanbin">
    <description>Channel bin width for spectral averaging</description>
    <value type="int">1</value>
    <allowed kind="enum" ignorecase="True">
        <value>1</value>
        <value>2</value>
        <value>4</value>
        <value>8</value>
        <value>16</value>
    </allowed>
  </param>

  <param type="string" name="timebin">
    <description>Bin width for time averaging</description>
    <value type="string">0s</value>
  </param>

  <param type="bool" name="replace">
    <description>Remove the parent ms and replace with the split ms</description>
    <value type="bool">True</value>
  </param>

  <param type="string" name="pipelinemode">
    <description>The pipeline operating mode</description>
    <value>automatic</value>
    <allowed kind="enum">
      <value>automatic</value>
      <value>interactive</value>
      <value>getinputs</value>
    </allowed>
  </param>

  <param type="bool" name="dryrun" subparam="true">
    <description>Run the task (False) or display the command(True)</description>
    <value>False</value>
  </param>

  <param type="bool" name="acceptresults" subparam="true">
    <description>Add the results to the pipeline context</description>
   <value>True</value>
  </param>


  <constraints>

    <when param="pipelinemode">
      <equals type="string" value="automatic">
      </equals>
      <equals type="string" value="interactive">
        <default param="vis"><value type="stringArray"></value></default>
        <default param="outputvis"><value type="stringArray"></value></default>
        <default param="field"><value type="string"></value></default>
        <default param="intent"><value type="string"></value></default>
        <default param="spw"><value type="string"></value></default>
        <default param="datacolumn"><value type="string">data</value></default>
        <default param="dryrun"><value type="bool">False</value></default>
        <default param="acceptresults"><value type="bool">True</value></default>
      </equals>
      <equals type="string" value="getinputs">
        <default param="vis"><value type="stringArray"></value></default>
        <default param="outputvis"><value type="stringArray"></value></default>
        <default param="field"><value type="string"></value></default>
        <default param="intent"><value type="string"></value></default>
        <default param="spw"><value type="string"></value></default>
        <default param="datacolumn"><value type="string">data</value></default>
      </equals>
    </when>

  </constraints>


</input>

<output>
    <param type="any" name="results">
        <description>The output results object</description>
        <any type="variant"/>
        <value></value>
    </param>
</output>
<returns type="void"/>


<example>

Create a list of science target MS(s) for imaging 

Keyword Arguments


pipelinemode -- The pipeline operating mode. In 'automatic' mode the pipeline
    determines the values of all context defined pipeline inputs automatically.
    In 'interactive' mode the user can set the pipeline context defined
    parameters manually.  In 'getinputs' mode the user can check the settings
    of all pipeline parameters without running the task.
    default: 'automatic'.

--- pipeline parameter arguments which can be set in any pipeline mode



---- pipeline context defined parameter arguments which can be set only in
     'interactive mode'

vis -- The list of input measurement sets to be transformed. Defaults to the
    list of measurement sets specified in the pipeline import data task.
    default '': Split all measurement sets in the context. 
    example: 'ngc5921.ms', ['ngc5921a.ms', ngc5921b.ms', 'ngc5921c.ms']

outputvis -- The list of output split measurement sets. The output list must
    be the same length as the input list and the output names must be different
    from the input names.
    default '', The output name defaults to &lt;msrootname&gt;_split.ms
    example: 'ngc5921.ms', ['ngc5921a.ms', ngc5921b.ms', 'ngc5921c.ms']

field -- Select fields name(s) or id(s) to split.
    default: '', All fields will be selected
    example: '3C279', '"5795"' Note the double quotes around names which can be interpreted as numbers

intent -- Select intents to split
    default: '', All data is selected.
    example: 'TARGET'

spw -- Select spectral windows to split.
    default: '', All spws are selected
    example: '9', '9,13,15'

datacolumn -- Select spectral windows to split. The standard CASA options are
    supported
    default: 'data', 
    example: 'corrected', 'model'

chanbin -- The channel binning factor. 1 for no binning, otherwise 2, 4, 8, or 16.
    supported
    default: 1, 
    example: 2, 4

timebin -- The time binning factor. '0s' for no binning
    default: '0s' 
    example: '10s' for 10 second binning

replace -- If a split was performed delete the parent MS and remove it from the context.
    default:  True
    example: False

--- pipeline task execution modes
dryrun -- Run the commands (True) or generate the commands to be run but
   do not execute (False).
   default: False

acceptresults -- Add the results of the task to the pipeline context (True) or
   reject them (False).
   default: True

Output

results -- If pipeline mode is 'getinputs' then None is returned. Otherwise
    the results object for the pipeline task is returned.

Description

Create new measurement sets for imaging from the corrected column of the input
measurement set. By default all science target data is copied to the new ms. The new
measurement set is not re-indexed to the selected data in the new ms will have the
same source, field, and spw names and ids as it does in the parent ms. 

Issues

TBD
Examples

1. Create a 4X channel smoothed output ms from the input ms 

   h_mssplit(chanbin=4)

</example>

</task>
</casaxml>

