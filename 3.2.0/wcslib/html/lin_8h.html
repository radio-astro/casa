<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
<title>WCSLIB 4.7: lin.h File Reference</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.6 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul>
      <li><a href="index.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
</div>
<div class="contents">
<h1>lin.h File Reference</h1>
<p>
<a href="lin_8h-source.html">Go to the source code of this file.</a><table border="0" cellpadding="0" cellspacing="0">
<tr><td></td></tr>
<tr><td colspan="2"><br><h2>Data Structures</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">struct &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="structlinprm.html">linprm</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Linear transformation parameters.  <a href="structlinprm.html#_details">More...</a><br></td></tr>
<tr><td colspan="2"><br><h2>Defines</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#fce62bec193631f6e6b58c5b786cd660">LINLEN</a>&nbsp;&nbsp;&nbsp;(sizeof(struct <a class="el" href="structlinprm.html">linprm</a>)/sizeof(int))</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Size of the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct in <em>int</em> units.  <a href="#fce62bec193631f6e6b58c5b786cd660"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#ffec8a2c0650ebd2168d7772b2ecec19">linini_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#ffec8a2c0650ebd2168d7772b2ecec19"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#58c2822debf5b36daa18fe8711d724f2">lincpy_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#58c2822debf5b36daa18fe8711d724f2"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#a6d3f59059c532b0217f570f2b4f50df">linfree_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#a6d3f59059c532b0217f570f2b4f50df"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#8970e09d61fde987211f8e64061e1fa1">linprt_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#8970e09d61fde987211f8e64061e1fa1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#a78f202b20674909aab523018106546e">linset_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#a78f202b20674909aab523018106546e"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#cb8c02645d7cc3d42e3db6ebf74de192">linp2x_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#cb8c02645d7cc3d42e3db6ebf74de192"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">#define&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#7232df93295216e063c438671652c2b4">linx2p_errmsg</a>&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a></td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Deprecated.  <a href="#7232df93295216e063c438671652c2b4"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#7ddea28768d99f01c6be1c71a4d8fe58">linini</a> (int alloc, int naxis, struct <a class="el" href="structlinprm.html">linprm</a> *lin)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Default constructor for the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct.  <a href="#7ddea28768d99f01c6be1c71a4d8fe58"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#b8fc0ef6b34eb3327b13a00de78232b1">lincpy</a> (int alloc, const struct <a class="el" href="structlinprm.html">linprm</a> *linsrc, struct <a class="el" href="structlinprm.html">linprm</a> *lindst)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Copy routine for the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct.  <a href="#b8fc0ef6b34eb3327b13a00de78232b1"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#ef9ead7c6ea6ab08f3ba3fc6a1c30303">linfree</a> (struct <a class="el" href="structlinprm.html">linprm</a> *lin)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Destructor for the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct.  <a href="#ef9ead7c6ea6ab08f3ba3fc6a1c30303"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#946005b038f5c584691630b5d39369e3">linprt</a> (const struct <a class="el" href="structlinprm.html">linprm</a> *lin)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Print routine for the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct.  <a href="#946005b038f5c584691630b5d39369e3"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#5c01c0991c8d0c4437581a7c1453b09a">linset</a> (struct <a class="el" href="structlinprm.html">linprm</a> *lin)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Setup routine for the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct.  <a href="#5c01c0991c8d0c4437581a7c1453b09a"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#e4947608476c198ad27759d1e562d655">linp2x</a> (struct <a class="el" href="structlinprm.html">linprm</a> *lin, int ncoord, int nelem, const double pixcrd[], double imgcrd[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Pixel-to-world linear transformation.  <a href="#e4947608476c198ad27759d1e562d655"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#5490027e9699680dfefe370c28691243">linx2p</a> (struct <a class="el" href="structlinprm.html">linprm</a> *lin, int ncoord, int nelem, const double imgcrd[], double pixcrd[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">World-to-pixel linear transformation.  <a href="#5490027e9699680dfefe370c28691243"></a><br></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">int&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#cc7d26efba3ca08d36047253a9315dcc">matinv</a> (int n, const double mat[], double inv[])</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Matrix inversion.  <a href="#cc7d26efba3ca08d36047253a9315dcc"></a><br></td></tr>
<tr><td colspan="2"><br><h2>Variables</h2></td></tr>
<tr><td class="memItemLeft" nowrap align="right" valign="top">const char *&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a> []</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Status return messages.  <a href="#7bdf034bd750df1e518db9feeebf7a79"></a><br></td></tr>
</table>
<hr><a name="_details"></a><h2>Detailed Description</h2>
These routines apply the linear transformation defined by the FITS WCS standard. They are based on the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct which contains all information needed for the computations. The struct contains some members that must be set by the user, and others that are maintained by these routines, somewhat like a C++ class but with no encapsulation.<p>
Three routines, <a class="el" href="lin_8h.html#7ddea28768d99f01c6be1c71a4d8fe58" title="Default constructor for the linprm struct.">linini()</a>, <a class="el" href="lin_8h.html#b8fc0ef6b34eb3327b13a00de78232b1" title="Copy routine for the linprm struct.">lincpy()</a>, and <a class="el" href="lin_8h.html#ef9ead7c6ea6ab08f3ba3fc6a1c30303" title="Destructor for the linprm struct.">linfree()</a> are provided to manage the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct, and another, <a class="el" href="lin_8h.html#946005b038f5c584691630b5d39369e3" title="Print routine for the linprm struct.">linprt()</a>, prints its contents.<p>
A setup routine, <a class="el" href="lin_8h.html#5c01c0991c8d0c4437581a7c1453b09a" title="Setup routine for the linprm struct.">linset()</a>, computes intermediate values in the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct from parameters in it that were supplied by the user. The struct always needs to be set up by <a class="el" href="lin_8h.html#5c01c0991c8d0c4437581a7c1453b09a" title="Setup routine for the linprm struct.">linset()</a> but need not be called explicitly - refer to the explanation of <a class="el" href="structlinprm.html#5bb0b2b2ce1f160a8a70f6437a893eea">linprm::flag</a>.<p>
<a class="el" href="lin_8h.html#e4947608476c198ad27759d1e562d655" title="Pixel-to-world linear transformation.">linp2x()</a> and <a class="el" href="lin_8h.html#5490027e9699680dfefe370c28691243" title="World-to-pixel linear transformation.">linx2p()</a> implement the WCS linear transformations.<p>
An auxiliary matrix inversion routine, <a class="el" href="lin_8h.html#cc7d26efba3ca08d36047253a9315dcc" title="Matrix inversion.">matinv()</a>, is included. It uses LU-triangular factorization with scaled partial pivoting. <hr><h2>Define Documentation</h2>
<a class="anchor" name="fce62bec193631f6e6b58c5b786cd660"></a><!-- doxytag: member="lin.h::LINLEN" ref="fce62bec193631f6e6b58c5b786cd660" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define LINLEN&nbsp;&nbsp;&nbsp;(sizeof(struct <a class="el" href="structlinprm.html">linprm</a>)/sizeof(int))          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Size of the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct in <em>int</em> units, used by the Fortran wrappers. 
</div>
</div><p>
<a class="anchor" name="ffec8a2c0650ebd2168d7772b2ecec19"></a><!-- doxytag: member="lin.h::linini_errmsg" ref="ffec8a2c0650ebd2168d7772b2ecec19" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define linini_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000007">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79" title="Status return messages.">lin_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="58c2822debf5b36daa18fe8711d724f2"></a><!-- doxytag: member="lin.h::lincpy_errmsg" ref="58c2822debf5b36daa18fe8711d724f2" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define lincpy_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000008">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79" title="Status return messages.">lin_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="a6d3f59059c532b0217f570f2b4f50df"></a><!-- doxytag: member="lin.h::linfree_errmsg" ref="a6d3f59059c532b0217f570f2b4f50df" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define linfree_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000009">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79" title="Status return messages.">lin_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="8970e09d61fde987211f8e64061e1fa1"></a><!-- doxytag: member="lin.h::linprt_errmsg" ref="8970e09d61fde987211f8e64061e1fa1" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define linprt_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000010">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79" title="Status return messages.">lin_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="a78f202b20674909aab523018106546e"></a><!-- doxytag: member="lin.h::linset_errmsg" ref="a78f202b20674909aab523018106546e" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define linset_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000011">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79" title="Status return messages.">lin_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="cb8c02645d7cc3d42e3db6ebf74de192"></a><!-- doxytag: member="lin.h::linp2x_errmsg" ref="cb8c02645d7cc3d42e3db6ebf74de192" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define linp2x_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000012">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79" title="Status return messages.">lin_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<a class="anchor" name="7232df93295216e063c438671652c2b4"></a><!-- doxytag: member="lin.h::linx2p_errmsg" ref="7232df93295216e063c438671652c2b4" args="" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define linx2p_errmsg&nbsp;&nbsp;&nbsp;<a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<dl compact><dt><b><a class="el" href="deprecated.html#_deprecated000013">Deprecated:</a></b></dt><dd>Added for backwards compatibility, use <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79" title="Status return messages.">lin_errmsg</a> directly now instead. </dd></dl>

</div>
</div><p>
<hr><h2>Function Documentation</h2>
<a class="anchor" name="7ddea28768d99f01c6be1c71a4d8fe58"></a><!-- doxytag: member="lin.h::linini" ref="7ddea28768d99f01c6be1c71a4d8fe58" args="(int alloc, int naxis, struct linprm *lin)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int linini           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>alloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>naxis</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>lin</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>linini</b>() allocates memory for arrays in a <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct and sets all members of the struct to default values.<p>
<b>PLEASE NOTE:</b> every <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct should be initialized by <b>linini</b>(), possibly repeatedly. On the first invokation, and only the first invokation, <a class="el" href="structlinprm.html#5bb0b2b2ce1f160a8a70f6437a893eea">linprm::flag</a> must be set to -1 to initialize memory management, regardless of whether <b>linini</b>() will actually be used to allocate memory.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alloc</em>&nbsp;</td><td>If true, allocate memory unconditionally for arrays in the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct. <br>
 If false, it is assumed that pointers to these arrays have been set by the user except if they are null pointers in which case memory will be allocated for them regardless. (In other words, setting alloc true saves having to initalize these pointers to zero.) </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>naxis</em>&nbsp;</td><td>The number of world coordinate axes, used to determine array sizes.</td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>lin</em>&nbsp;</td><td>Linear transformation parameters. Note that, in order to initialize memory management <a class="el" href="structlinprm.html#5bb0b2b2ce1f160a8a70f6437a893eea">linprm::flag</a> should be set to -1 when lin is initialized for the first time (memory leaks may result if it had already been initialized).</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> pointer passed.</li><li>2: Memory allocation failed. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="b8fc0ef6b34eb3327b13a00de78232b1"></a><!-- doxytag: member="lin.h::lincpy" ref="b8fc0ef6b34eb3327b13a00de78232b1" args="(int alloc, const struct linprm *linsrc, struct linprm *lindst)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int lincpy           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>alloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>linsrc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>lindst</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>lincpy</b>() does a deep copy of one <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct to another, using <a class="el" href="lin_8h.html#7ddea28768d99f01c6be1c71a4d8fe58" title="Default constructor for the linprm struct.">linini()</a> to allocate memory for its arrays if required. Only the "information to be provided" part of the struct is copied; a call to <a class="el" href="lin_8h.html#5c01c0991c8d0c4437581a7c1453b09a" title="Setup routine for the linprm struct.">linset()</a> is required to initialize the remainder.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>alloc</em>&nbsp;</td><td>If true, allocate memory for the crpix, pc, and cdelt arrays in the destination. Otherwise, it is assumed that pointers to these arrays have been set by the user except if they are null pointers in which case memory will be allocated for them regardless. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>linsrc</em>&nbsp;</td><td>Struct to copy from.</td></tr>
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>lindst</em>&nbsp;</td><td>Struct to copy to. <a class="el" href="structlinprm.html#5bb0b2b2ce1f160a8a70f6437a893eea">linprm::flag</a> should be set to -1 if lindst was not previously initialized (memory leaks may result if it was previously initialized).</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> pointer passed.</li><li>2: Memory allocation failed. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="ef9ead7c6ea6ab08f3ba3fc6a1c30303"></a><!-- doxytag: member="lin.h::linfree" ref="ef9ead7c6ea6ab08f3ba3fc6a1c30303" args="(struct linprm *lin)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int linfree           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>lin</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>linfree</b>() frees memory allocated for the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> arrays by <a class="el" href="lin_8h.html#7ddea28768d99f01c6be1c71a4d8fe58" title="Default constructor for the linprm struct.">linini()</a> and/or <a class="el" href="lin_8h.html#5c01c0991c8d0c4437581a7c1453b09a" title="Setup routine for the linprm struct.">linset()</a>. <a class="el" href="lin_8h.html#7ddea28768d99f01c6be1c71a4d8fe58" title="Default constructor for the linprm struct.">linini()</a> keeps a record of the memory it allocates and <b>linfree</b>() will only attempt to free this.<p>
<b>PLEASE NOTE:</b> <b>linfree</b>() must not be invoked on a <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct that was not initialized by <a class="el" href="lin_8h.html#7ddea28768d99f01c6be1c71a4d8fe58" title="Default constructor for the linprm struct.">linini()</a>.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lin</em>&nbsp;</td><td>Linear transformation parameters.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> pointer passed. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="946005b038f5c584691630b5d39369e3"></a><!-- doxytag: member="lin.h::linprt" ref="946005b038f5c584691630b5d39369e3" args="(const struct linprm *lin)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int linprt           </td>
          <td>(</td>
          <td class="paramtype">const struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>lin</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>linprt</b>() prints the contents of a <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>lin</em>&nbsp;</td><td>Linear transformation parameters.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> pointer passed. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="5c01c0991c8d0c4437581a7c1453b09a"></a><!-- doxytag: member="lin.h::linset" ref="5c01c0991c8d0c4437581a7c1453b09a" args="(struct linprm *lin)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int linset           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>lin</em>          </td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>linset</b>(), if necessary, allocates memory for the <a class="el" href="structlinprm.html#eaaf26fd243da58fee173b075bed1de7">linprm::piximg</a> and <a class="el" href="structlinprm.html#28a705f744a32cd05dd3aa86ca58998b">linprm::imgpix</a> arrays and sets up the <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> struct according to information supplied within it - refer to the explanation of <a class="el" href="structlinprm.html#5bb0b2b2ce1f160a8a70f6437a893eea">linprm::flag</a>.<p>
Note that this routine need not be called directly; it will be invoked by <a class="el" href="lin_8h.html#e4947608476c198ad27759d1e562d655" title="Pixel-to-world linear transformation.">linp2x()</a> and <a class="el" href="lin_8h.html#5490027e9699680dfefe370c28691243" title="World-to-pixel linear transformation.">linx2p()</a> if the <a class="el" href="structlinprm.html#5bb0b2b2ce1f160a8a70f6437a893eea">linprm::flag</a> is anything other than a predefined magic value.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>lin</em>&nbsp;</td><td>Linear transformation parameters.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: <code><b>PC</b>i<b>_</b>ja</code> matrix is singular. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="e4947608476c198ad27759d1e562d655"></a><!-- doxytag: member="lin.h::linp2x" ref="e4947608476c198ad27759d1e562d655" args="(struct linprm *lin, int ncoord, int nelem, const double pixcrd[], double imgcrd[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int linp2x           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>lin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ncoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>pixcrd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>imgcrd</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>linp2x</b>() transforms pixel coordinates to intermediate world coordinates.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>lin</em>&nbsp;</td><td>Linear transformation parameters.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ncoord,nelem</em>&nbsp;</td><td>The number of coordinates, each of vector length nelem but containing lin.naxis coordinate elements. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>pixcrd</em>&nbsp;</td><td>Array of pixel coordinates.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>imgcrd</em>&nbsp;</td><td>Array of intermediate world coordinates.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: <code><b>PC</b>i<b>_</b>ja</code> matrix is singular. </li></ul>
</dd></dl>

</div>
</div><p>
<a class="anchor" name="5490027e9699680dfefe370c28691243"></a><!-- doxytag: member="lin.h::linx2p" ref="5490027e9699680dfefe370c28691243" args="(struct linprm *lin, int ncoord, int nelem, const double imgcrd[], double pixcrd[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int linx2p           </td>
          <td>(</td>
          <td class="paramtype">struct <a class="el" href="structlinprm.html">linprm</a> *&nbsp;</td>
          <td class="paramname"> <em>lin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>ncoord</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>nelem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>imgcrd</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>pixcrd</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>linx2p</b>() transforms intermediate world coordinates to pixel coordinates.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in,out]</tt>&nbsp;</td><td valign="top"><em>lin</em>&nbsp;</td><td>Linear transformation parameters.</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>ncoord,nelem</em>&nbsp;</td><td>The number of coordinates, each of vector length nelem but containing lin.naxis coordinate elements. </td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>imgcrd</em>&nbsp;</td><td>Array of intermediate world coordinates.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>pixcrd</em>&nbsp;</td><td>Array of pixel coordinates. Status return value:<ul>
<li>0: Success.</li><li>1: Null <a class="el" href="structlinprm.html" title="Linear transformation parameters.">linprm</a> pointer passed.</li><li>2: Memory allocation failed.</li><li>3: <code><b>PC</b>i<b>_</b>ja</code> matrix is singular. </li></ul>
</td></tr>
  </table>
</dl>

</div>
</div><p>
<a class="anchor" name="cc7d26efba3ca08d36047253a9315dcc"></a><!-- doxytag: member="lin.h::matinv" ref="cc7d26efba3ca08d36047253a9315dcc" args="(int n, const double mat[], double inv[])" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">matinv           </td>
          <td>(</td>
          <td class="paramtype">int&nbsp;</td>
          <td class="paramname"> <em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&nbsp;</td>
          <td class="paramname"> <em>mat</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&nbsp;</td>
          <td class="paramname"> <em>inv</em>[]</td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
<b>matinv</b>() performs matrix inversion using LU-triangular factorization with scaled partial pivoting.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>n</em>&nbsp;</td><td>Order of the matrix (<img class="formulaInl" alt="$n \times n$" src="form_12.png">).</td></tr>
    <tr><td valign="top"><tt>[in]</tt>&nbsp;</td><td valign="top"><em>mat</em>&nbsp;</td><td>Matrix to be inverted, stored as mat[<img class="formulaInl" alt="$i n + j$" src="form_13.png">] where <img class="formulaInl" alt="$i$" src="form_14.png"> and <img class="formulaInl" alt="$j$" src="form_15.png"> are the row and column indices respectively.</td></tr>
    <tr><td valign="top"><tt>[out]</tt>&nbsp;</td><td valign="top"><em>inv</em>&nbsp;</td><td>Inverse of mat with the same storage convention.</td></tr>
  </table>
</dl>
<dl class="return" compact><dt><b>Returns:</b></dt><dd>Status return value:<ul>
<li>0: Success.</li><li>2: Memory allocation failed.</li><li>3: Singular matrix. </li></ul>
</dd></dl>

</div>
</div><p>
<hr><h2>Variable Documentation</h2>
<a class="anchor" name="7bdf034bd750df1e518db9feeebf7a79"></a><!-- doxytag: member="lin.h::lin_errmsg" ref="7bdf034bd750df1e518db9feeebf7a79" args="[]" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const char * <a class="el" href="lin_8h.html#7bdf034bd750df1e518db9feeebf7a79">lin_errmsg</a>[]          </td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>
Error messages to match the status value returned from each function. 
</div>
</div><p>
</div>
<hr size="1"><address style="text-align: right;"><small>Generated on Mon Feb 7 18:03:57 2011 for WCSLIB 4.7 by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.6 </small></address>
</body>
</html>
